<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Messenger</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/chat.css">
    <link rel="stylesheet" href="css/search.css">
    <link rel="stylesheet" href="css/profile.css">
    <link rel="stylesheet" href="css/contacts.css">
    <link rel="stylesheet" href="css/chats-list.css">
    <link rel="stylesheet" href="css/context-menu.css">
    <link rel="stylesheet" href="css/profile-editor.css">
</head>
<body>
    <!-- <script>
        // Ð˜Ð¡ÐŸÐ ÐÐ’Ð›Ð•ÐÐÐ«Ð™ DEBUG ÐšÐžÐ”
        (function() {
            console.log('%cðŸ” DEBUG: Page loaded', 'background: #222; color: #bada55');
            
            // ÐžÑ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°ÐµÐ¼ Ð²ÑÐµ submit ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ
            document.addEventListener('submit', function(e) {
                console.log('%cðŸš¨ SUBMIT EVENT DETECTED!', 'background: red; color: white; font-size: 16px;');
                console.log('Target:', e.target);
                console.log('Form action:', e.target.action);
                console.log('Form method:', e.target.method);
                console.trace();
                
                // Ð’ÑÐµÐ³Ð´Ð° Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ submit ÐºÑ€Ð¾Ð¼Ðµ auth Ñ„Ð¾Ñ€Ð¼
                if (!e.target.classList.contains('auth-form')) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('%câœ‹ Submit prevented', 'background: orange; color: white;');
                }
            }, true);
            
            // ÐžÑ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ click ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÐ°Ñ…
            document.addEventListener('click', function(e) {
                if (e.target.tagName === 'BUTTON') {
                    console.log('%cðŸ–±ï¸ Button clicked:', 'background: blue; color: white;', {
                        element: e.target,
                        type: e.target.type,
                        className: e.target.className,
                        innerText: e.target.innerText,
                        formElement: e.target.form
                    });
                }
            }, true);
            
            // ÐžÑ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ beforeunload Ð¸ unload
            window.addEventListener('beforeunload', function(e) {
                console.log('%cðŸ”„ BEFOREUNLOAD TRIGGERED!', 'background: red; color: yellow; font-size: 16px;');
                console.trace();
            });
            
            window.addEventListener('unload', function(e) {
                console.log('%cðŸ”„ UNLOAD TRIGGERED!', 'background: darkred; color: white; font-size: 16px;');
            });
            
            // ÐžÑ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°ÐµÐ¼ navigation/history changes
            const originalPushState = history.pushState;
            const originalReplaceState = history.replaceState;
            
            history.pushState = function() {
                console.log('%cðŸ“ history.pushState:', 'background: purple; color: white;', arguments);
                return originalPushState.apply(history, arguments);
            };
            
            history.replaceState = function() {
                console.log('%cðŸ“ history.replaceState:', 'background: purple; color: white;', arguments);
                return originalReplaceState.apply(history, arguments);
            };
            
            // ÐžÑ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°ÐµÐ¼ window.location changes (Ð½Ð¾ Ð‘Ð•Ð— Ð¿ÐµÑ€ÐµÐ¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ)
            let currentHref = window.location.href;
            setInterval(function() {
                if (window.location.href !== currentHref) {
                    console.log('%cðŸŒ Location changed:', 'background: red; color: white; font-size: 16px;', {
                        from: currentHref,
                        to: window.location.href
                    });
                    console.trace();
                    currentHref = window.location.href;
                }
            }, 100);

            // Ð‘Ð›ÐžÐšÐ˜Ð Ð£Ð•Ðœ Ð’Ð¡Ð• WEBSOCKET Ð¡ÐžÐ•Ð”Ð˜ÐÐ•ÐÐ˜Ð¯
            // const originalWebSocket = window.WebSocket;
            // window.WebSocket = function(url, protocols) {
            //     console.log('ðŸš« WebSocket blocked:', url);
            //     return {
            //         addEventListener: () => {},
            //         removeEventListener: () => {},
            //         send: () => {},
            //         close: () => {},
            //         readyState: 3 // CLOSED
            //     };
            // };
        })();
    </script> -->
    <div class="main-container">
        <div class="left-container"></div>
        <div class="right-container"></div>
    </div>

    <!-- Ð¡ÐµÑ€Ð²Ð¸ÑÑ‹ -->
    <script src="js/storage/mock/mock-data-service.js"></script>

    <script src="js/storage/api/service-interface.js"></script>
    <script src="js/storage/api/local.js"></script>
    <script src="js/storage/api/http.js"></script>
    <script src="js/storage/api/factory.js"></script>

    <script src="js/auth/auth-storage.js"></script>
   <script src="js/auth/auth-guard.js"></script>
    
    <script src="js/storage/user-service.js"></script>
    <script src="js/storage/message-service.js"></script>

    <!-- ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ñ‹ Ð¿Ð°Ð½ÐµÐ»ÐµÐ¹ -->
    <script src="js/app/left-panel-manager.js"></script>
    <script src="js/app/right-panel-manager.js"></script>
    
    <!-- ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹ Ð»ÐµÐ²Ð¾Ð¹ Ð¿Ð°Ð½ÐµÐ»Ð¸ -->
    <script src="js/components/chats-list/chats.js"></script>
    <script src="js/components/chats-list/renderer.js"></script>
    <script src="js/components/chats-list/data-loader.js"></script>
    
    <script src="js/components/profile/profile.js"></script>
    <script src="js/components/profile/renderer.js"></script>
    <script src="js/components/profile/data-loader.js"></script>
    <script src="js/components/profile/contacts.js"></script>
    
    <script src="js/components/search/search.js"></script>
    <script src="js/components/search/renderer.js"></script>
    <script src="js/components/search/data-loader.js"></script>
    
    <script src="js/components/profile-editor/editor.js"></script>
    <script src="js/components/profile-editor/avatar-uploader.js"></script>
    <script src="js/components/profile-editor/save-manager.js"></script>
    <script src="js/components/profile-editor/form-validator.js"></script>

    <!-- ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹ Ð¿Ñ€Ð°Ð²Ð¾Ð¹ Ð¿Ð°Ð½ÐµÐ»Ð¸ -->
    <script src="js/components/chat/chat.js"></script>
    <script src="js/components/chat/data-loader.js"></script>
    
    <!-- ÐŸÐ¾ÑÐ»Ðµ Ð´Ñ€ÑƒÐ³Ð¸Ñ… ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð², Ð¿ÐµÑ€ÐµÐ´ app.js -->
    <script src="js/websocket/client.js"></script>
    <!-- Ð“Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ -->
    <script src="js/app/eventbus.js"></script>
    <script src="js/app/app.js"></script>

    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            window.authGuard.requireAuth(() => {
                window.app = new App();
                window.app.init();
            });
        });
    </script>
</body>
</html>